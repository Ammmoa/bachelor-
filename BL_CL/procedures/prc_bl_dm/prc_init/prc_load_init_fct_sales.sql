CREATE OR REPLACE PROCEDURE BL_CL.prc_load_init_fct_sales()
LANGUAGE plpgsql
AS $$
BEGIN 
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES (
	AMOUNT INT,
	MMR INT,
	PROFIT INT,
	EMPLOYEE_SURR_ID INT,
	CUSTOMER_SURR_ID INT,
	MODEL_SURR_ID INT,
	PRODUCT_SURR_ID INT,
	DATE_SURR_ID DATE,
	TIME TIME,
	TA_INSERT_DT DATE,
	TA_UPDATE_DT DATE,
	SOURCE_SYSTEM VARCHAR(50),
	SOURCE_ENTITY VARCHAR(50),
	SOURCE_ID VARCHAR(50)
	) 
	PARTITION BY RANGE (date_surr_id);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2010_1st_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2010-01-01'::date) TO ('2010-07-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2010_2nd_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2010-07-01'::date) TO ('2011-01-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2011_1st_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2011-01-01'::date) TO ('2011-07-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2011_2nd_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2011-07-01'::date) TO ('2012-01-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2012_1st_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2012-01-01'::date) TO ('2012-07-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2012_2nd_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2012-07-01'::date) TO ('2013-01-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2013_1st_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2013-01-01'::date) TO ('2013-07-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2013_2nd_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2013-07-01'::date) TO ('2014-01-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2014_1st_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2014-01-01'::date) TO ('2014-07-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2014_2nd_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2014-07-01'::date) TO ('2015-01-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2015_1st_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2015-01-01'::date) TO ('2015-07-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2015_2nd_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2015-07-01'::date) TO ('2016-01-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2016_1st_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2016-01-01'::date) TO ('2016-07-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2016_2nd_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2016-07-01'::date) TO ('2017-01-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2017_1st_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2017-01-01'::date) TO ('2017-07-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2017_2nd_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2017-07-01'::date) TO ('2018-01-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2018_1st_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2018-01-01'::date) TO ('2018-07-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2018_2nd_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2018-07-01'::date) TO ('2019-01-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2019_1st_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2019-01-01'::date) TO ('2019-07-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2019_2nd_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2019-07-01'::date) TO ('2020-01-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2020_1st_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2020-01-01'::date) TO ('2020-07-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2020_2nd_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2020-07-01'::date) TO ('2021-01-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2021_1st_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2021-01-01'::date) TO ('2021-07-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2021_2nd_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2021-07-01'::date) TO ('2022-01-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2022_1st_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2022-01-01'::date) TO ('2022-07-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2022_2nd_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2022-07-01'::date) TO ('2023-01-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2023_1st_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2023-01-01'::date) TO ('2023-07-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2023_2nd_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2023-07-01'::date) TO ('2024-01-01'::date);
	
	CREATE TABLE IF NOT EXISTS BL_DM.FCT_SALES_2024_1st_semiyear
	PARTITION OF BL_DM.FCT_SALES FOR VALUES FROM ('2024-01-01'::date) TO ('2024-07-01'::date);
	
	--ALTER TABLE BL_DM.FCT_SALES DETACH PARTITION FCT_SALES_1st_semiyear;
	--DROP TABLE  FCT_SALES_1st_semiyear;

	RETURN;
END;$$;